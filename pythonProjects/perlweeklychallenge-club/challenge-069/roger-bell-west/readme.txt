For problem #2:

ch-2a is the utility code that enabled me to find the solution.

ch-2b is the code that outputs the desired answer (yes, even for S=1000).
